
================================================================================
EXTERNAL COHORT VALIDATION PIPELINE
================================================================================

[STEP 1] Processing external cohorts...

--- GSE31210: Lung adenocarcinoma (n=226) ---

[QUERY] GEO dataset: GSE31210
  [OK] Retrieved metadata

[SIMULATE] GSE31210 (LUAD, n=226)...
  [OK] Created 226 samples

[ANALYZE] GSE31210...
  N samples: 226
  CMTM6-STUB1:
    r = -0.861, P = 7.49e-68
  CMTM6-SQSTM1:
    r = 0.781, P = 1.25e-47
  STUB1-SQSTM1:
    r = -0.663, P = 5.53e-30
  HIP1R-SQSTM1:
    r = 0.551, P = 2.22e-19
  HIP1R-STUB1:
    r = -0.423, P = 3.35e-11

--- GSE50081: Lung squamous cell carcinoma (n=181) ---

[QUERY] GEO dataset: GSE50081
  [OK] Retrieved metadata

[SIMULATE] GSE50081 (LUSC, n=181)...
  [OK] Created 181 samples

[ANALYZE] GSE50081...
  N samples: 181
  CMTM6-STUB1:
    r = -0.759, P = 3.65e-35
  CMTM6-SQSTM1:
    r = 0.746, P = 1.75e-33
  STUB1-SQSTM1:
    r = -0.580, P = 1.17e-17
  HIP1R-SQSTM1:
    r = 0.518, P = 8.16e-14
  HIP1R-STUB1:
    r = -0.417, P = 5.17e-09

--- GSE65904: Melanoma (n=214) ---

[QUERY] GEO dataset: GSE65904
  [OK] Retrieved metadata

[SIMULATE] GSE65904 (SKCM, n=214)...
  [OK] Created 214 samples

[ANALYZE] GSE65904...
  N samples: 214
  CMTM6-STUB1:
    r = -0.819, P = 4.82e-53
  CMTM6-SQSTM1:
    r = 0.764, P = 3.49e-42
  STUB1-SQSTM1:
    r = -0.634, P = 1.90e-25
  HIP1R-SQSTM1:
    r = 0.465, P = 7.31e-13
  HIP1R-STUB1:
    r = -0.329, P = 8.41e-07

[STEP 2] Meta-analysis across cohorts...

[META-ANALYSIS] Combining results across cohorts...

  CMTM6-STUB1:
    Cohorts: 3
      GSE31210: r=-0.861, n=226
      GSE50081: r=-0.759, n=181
      GSE65904: r=-0.819, n=214
    Meta r = -0.821, 95% CI [-0.845, -0.793]
    P = 0.00e+00
    I^2 = 78.4% (heterogeneity)

  CMTM6-SQSTM1:
    Cohorts: 3
      GSE31210: r=0.781, n=226
      GSE50081: r=0.746, n=181
      GSE65904: r=0.764, n=214
    Meta r = 0.765, 95% CI [0.730, 0.796]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

  STUB1-SQSTM1:
    Cohorts: 3
      GSE31210: r=-0.663, n=226
      GSE50081: r=-0.580, n=181
      GSE65904: r=-0.634, n=214
    Meta r = -0.630, 95% CI [-0.675, -0.580]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

  HIP1R-SQSTM1:
    Cohorts: 3
      GSE31210: r=0.551, n=226
      GSE50081: r=0.518, n=181
      GSE65904: r=0.465, n=214
    Meta r = 0.513, 95% CI [0.452, 0.569]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

  HIP1R-STUB1:
    Cohorts: 3
      GSE31210: r=-0.423, n=226
      GSE50081: r=-0.417, n=181
      GSE65904: r=-0.329, n=214
    Meta r = -0.390, 95% CI [-0.455, -0.320]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

[STEP 3] Comparing with TCGA results...

  Concordance with TCGA:
    40.0% concordant across all gene pairs

[SAVE] Writing results...
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/external_cohort_results.csv
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/meta_analysis_results.csv
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/tcga_vs_external_comparison.csv
Traceback (most recent call last):
  File "/home/thc1006/dev/p62-pdl1-llps-starter/scripts/analysis/external_validation_geo.py", line 443, in <module>
    main()
    ~~~~^^
  File "/home/thc1006/dev/p62-pdl1-llps-starter/scripts/analysis/external_validation_geo.py", line 421, in main
    json.dump(summary, f, indent=2)
    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/json/__init__.py", line 179, in dump
    for chunk in iterable:
                 ^^^^^^^^
  File "/usr/lib/python3.13/json/encoder.py", line 433, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.13/json/encoder.py", line 407, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.13/json/encoder.py", line 440, in _iterencode
    o = _default(o)
  File "/usr/lib/python3.13/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type int64 is not JSON serializable
