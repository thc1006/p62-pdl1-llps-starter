======================================================================
STAGE 2 v2: STRATIFIED MULTIVARIATE COX ANALYSIS
======================================================================

 FIXES:
  - Stratified Cox by cancer type (avoids baseline hazard violation)
  - Schoenfeld residuals test for proportional hazards
  - VIF analysis for multicollinearity
  - Per-cancer Cox models + meta-analysis
======================================================================

[STEP 1] Loading data...
  Expression: 1635 samples
  ⚠️  Detected Ensembl IDs - converting to gene symbols
     ENSG00000120217 → CD274
     ENSG00000091317 → CMTM6
     ENSG00000103266 → STUB1
     ENSG00000107018 → HIP1R
     ENSG00000161011 → SQSTM1
  ✓ Converted 5 genes to symbols
   WARNING: Using simulated clinical data
  MUST replace with real TCGA clinical before publication!
  Clinical: 1635 records

[STEP 2] Merging data...
  Merged: 1635 samples
  Final: 1635 samples
  Events: 888 (54.3%)

[STEP 3] Stratified Cox regression (by cancer type)...
Traceback (most recent call last):
  File "/home/thc1006/dev/p62-pdl1-llps-starter/scripts/excellence_upgrade/stage2_v2_stratified_cox.py", line 174, in <module>
    cox_data = merged_df[cox_columns].dropna()
               ~~~~~~~~~^^^^^^^^^^^^^
  File "/home/thc1006/dev/p62-pdl1-llps-starter/venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/thc1006/dev/p62-pdl1-llps-starter/venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/thc1006/dev/p62-pdl1-llps-starter/venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['cancer_type'] not in index"
