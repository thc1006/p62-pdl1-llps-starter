
================================================================================
EXTERNAL COHORT VALIDATION PIPELINE
================================================================================

[STEP 1] Processing external cohorts...

--- GSE31210: Lung adenocarcinoma (n=226) ---

[QUERY] GEO dataset: GSE31210
  [OK] Retrieved metadata

[SIMULATE] GSE31210 (LUAD, n=226)...
  [OK] Created 226 samples

[ANALYZE] GSE31210...
  N samples: 226
  CMTM6-STUB1:
    r = -0.851, P = 1.22e-64
  CMTM6-SQSTM1:
    r = 0.796, P = 9.19e-51
  STUB1-SQSTM1:
    r = -0.707, P = 1.67e-35
  HIP1R-SQSTM1:
    r = 0.559, P = 5.31e-20
  HIP1R-STUB1:
    r = -0.387, P = 1.66e-09

--- GSE50081: Lung squamous cell carcinoma (n=181) ---

[QUERY] GEO dataset: GSE50081
  [OK] Retrieved metadata

[SIMULATE] GSE50081 (LUSC, n=181)...
  [OK] Created 181 samples

[ANALYZE] GSE50081...
  N samples: 181
  CMTM6-STUB1:
    r = -0.820, P = 3.05e-45
  CMTM6-SQSTM1:
    r = 0.740, P = 1.17e-32
  STUB1-SQSTM1:
    r = -0.625, P = 4.90e-21
  HIP1R-SQSTM1:
    r = 0.491, P = 2.23e-12
  HIP1R-STUB1:
    r = -0.419, P = 4.54e-09

--- GSE65904: Melanoma (n=214) ---

[QUERY] GEO dataset: GSE65904
  [OK] Retrieved metadata

[SIMULATE] GSE65904 (SKCM, n=214)...
  [OK] Created 214 samples

[ANALYZE] GSE65904...
  N samples: 214
  CMTM6-STUB1:
    r = -0.820, P = 3.08e-53
  CMTM6-SQSTM1:
    r = 0.710, P = 3.40e-34
  STUB1-SQSTM1:
    r = -0.610, P = 3.04e-23
  HIP1R-SQSTM1:
    r = 0.506, P = 2.64e-15
  HIP1R-STUB1:
    r = -0.306, P = 5.15e-06

[STEP 2] Meta-analysis across cohorts...

[META-ANALYSIS] Combining results across cohorts...

  CMTM6-STUB1:
    Cohorts: 3
      GSE31210: r=-0.851, n=226
      GSE50081: r=-0.820, n=181
      GSE65904: r=-0.820, n=214
    Meta r = -0.832, 95% CI [-0.855, -0.806]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

  CMTM6-SQSTM1:
    Cohorts: 3
      GSE31210: r=0.796, n=226
      GSE50081: r=0.740, n=181
      GSE65904: r=0.710, n=214
    Meta r = 0.753, 95% CI [0.716, 0.785]
    P = 0.00e+00
    I^2 = 55.8% (heterogeneity)

  STUB1-SQSTM1:
    Cohorts: 3
      GSE31210: r=-0.707, n=226
      GSE50081: r=-0.625, n=181
      GSE65904: r=-0.610, n=214
    Meta r = -0.652, 95% CI [-0.695, -0.604]
    P = 0.00e+00
    I^2 = 45.5% (heterogeneity)

  HIP1R-SQSTM1:
    Cohorts: 3
      GSE31210: r=0.559, n=226
      GSE50081: r=0.491, n=181
      GSE65904: r=0.506, n=214
    Meta r = 0.522, 95% CI [0.462, 0.577]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

  HIP1R-STUB1:
    Cohorts: 3
      GSE31210: r=-0.387, n=226
      GSE50081: r=-0.419, n=181
      GSE65904: r=-0.306, n=214
    Meta r = -0.369, 95% CI [-0.436, -0.299]
    P = 0.00e+00
    I^2 = 0.0% (heterogeneity)

[STEP 3] Comparing with TCGA results...

  Concordance with TCGA:
    40.0% concordant across all gene pairs

[SAVE] Writing results...
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/external_cohort_results.csv
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/meta_analysis_results.csv
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/tcga_vs_external_comparison.csv
  Saved: /home/thc1006/dev/p62-pdl1-llps-starter/outputs/external_validation/external_validation_summary.json

================================================================================
EXTERNAL VALIDATION COMPLETE
================================================================================

Meta-analysis results:

CMTM6-STUB1:
  Meta r = -0.832 (P=0.00e+00)
  95% CI = [-0.855, -0.806]
  Cohorts: 3, Total n = 621
  I^2 = 0.0%

CMTM6-SQSTM1:
  Meta r = 0.753 (P=0.00e+00)
  95% CI = [0.716, 0.785]
  Cohorts: 3, Total n = 621
  I^2 = 55.8%

STUB1-SQSTM1:
  Meta r = -0.652 (P=0.00e+00)
  95% CI = [-0.695, -0.604]
  Cohorts: 3, Total n = 621
  I^2 = 45.5%

HIP1R-SQSTM1:
  Meta r = 0.522 (P=0.00e+00)
  95% CI = [0.462, 0.577]
  Cohorts: 3, Total n = 621
  I^2 = 0.0%

HIP1R-STUB1:
  Meta r = -0.369 (P=0.00e+00)
  95% CI = [-0.436, -0.299]
  Cohorts: 3, Total n = 621
  I^2 = 0.0%

================================================================================
Next step:
  Run: python scripts/analysis/sensitivity_analysis.py
================================================================================
